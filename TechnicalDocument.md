# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç: –°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
7. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
8. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### –¶–µ–ª—å
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±—ç–∫–µ–Ω–¥-—Å–∏—Å—Ç–µ–º—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–º–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GraphQL API, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ —á—Ç–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤
- ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å)
- ‚úÖ Real-time –ø–æ–¥–ø–∏—Å–∫–∏ —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –ø–æ—Å—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è –ø–æ—Å—Ç–∞
- ‚úÖ GraphQL Playground –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç
- ‚úÖ Clean Architecture —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è |
|-----------|------------|--------|
| **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è** | Go | 1.22+ |
| **Web Framework** | Chi Router | v5 |
| **API** | GraphQL | graphql-go/graphql |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | PostgreSQL | 15 |
| **–î—Ä–∞–π–≤–µ—Ä –ë–î** | pgx/v5 | v5.5.5 |
| **WebSockets** | gorilla/websocket | - |
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** | Docker + Docker Compose | - |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | Clean Architecture | - |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | GraphQL Playground | - |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Clean Architecture

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º —Å–ª–æ–µ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–æ–≤ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    API Layer (HTTP/WebSocket)               ‚îÇ
‚îÇ                          ‚Üï converters                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                  Service Layer (Business Logic)             ‚îÇ
‚îÇ                          ‚Üï interfaces                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                Repository Layer (Data Access)               ‚îÇ
‚îÇ                          ‚Üï converters                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                    Domain Layer (Models)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

#### 1. **Domain Layer** (`internal/model/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ß–∏—Å—Ç—ã–µ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `entities.go` - –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (Post, Comment, PostWithComments, CommentTree)
  - –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏
  - –ú–µ—Ç–æ–¥—ã –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ (IsValidTitle, IsValidContent, IsValidComment)

#### 2. **Repository Layer** (`internal/repository/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `storage.go` - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
  - `postgres.go` - PostgreSQL —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
  - `model/storage_models.go` - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–∞–∑—ã
  - `converter/converter.go` - –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –º–µ–∂–¥—É –¥–æ–º–µ–Ω–Ω—ã–º–∏ –∏ –ë–î –º–æ–¥–µ–ª—è–º–∏

#### 3. **Service Layer** (`internal/service/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ GraphQL —Ä–µ–∑–æ–ª–≤–µ—Ä—ã
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `service.go` - GraphQL —Å—Ö–µ–º–∞ –∏ —Å–µ—Ä–≤–∏—Å
  - `resolvers.go` - –†–µ–∑–æ–ª–≤–µ—Ä—ã –¥–ª—è Query, Mutation, Subscription
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Pub/Sub
  - Health check –ª–æ–≥–∏–∫–∞

#### 4. **API Layer** (`internal/api/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `handler.go` - GraphQL HTTP —Ö–µ–Ω–¥–ª–µ—Ä –∏ WebSocket
  - CORS middleware
  - GraphQL Playground
  - Health check endpoint

#### 5. **Converter Layer** (`internal/converter/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ API –∏ Domain
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
  - `api_converter.go` - –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –¥–ª—è API (GraphQL)
  - GraphQLConverter - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ GraphQL –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
  - ValidationConverter - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
CommentsSystem/
‚îú‚îÄ‚îÄ üìÅ cmd/                          # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ app/
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ main.go               # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ üìÅ internal/                     # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞ (–Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ api/                      # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ handler.go            # GraphQL –∏ WebSocket —Ö–µ–Ω–¥–ª–µ—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ config/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ config.go             # –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ model/                    # –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (Domain Layer)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ entities.go           # –ß–∏—Å—Ç—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ converter/                # –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã API ‚Üî Domain
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ api_converter.go      # GraphQL –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ repository/               # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ storage.go            # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ postgres.go           # PostgreSQL —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ postgres_test.go      # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ model/                # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ë–î
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ storage_models.go # PostDB, CommentDB –∏ –¥—Ä.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ converter/            # –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã Domain ‚Üî Storage
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ üìÑ converter.go      # PostConverter, CommentConverter
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ service/                  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ service.go            # GraphQL —Å—Ö–µ–º–∞ –∏ —Å–µ—Ä–≤–∏—Å
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ resolvers.go          # GraphQL —Ä–µ–∑–æ–ª–≤–µ—Ä—ã
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ service_test.go       # Unit —Ç–µ—Å—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ üìÅ pkg/                          # –ü—É–±–ª–∏—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ pubsub/                   # Pub/Sub —Å–∏—Å—Ç–µ–º–∞
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ pubsub.go             # In-memory Pub/Sub
‚îÇ
‚îú‚îÄ‚îÄ üìÅ migrations/                   # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ 001_init_schema.sql      # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã
‚îÇ
‚îú‚îÄ‚îÄ üìÑ go.mod                        # Go –º–æ–¥—É–ª—å –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ üìÑ go.sum                        # –•–µ—à–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ üìÑ Dockerfile                    # –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml           # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ üìÑ Makefile                     # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ üìÑ .gitignore                   # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git
‚îú‚îÄ‚îÄ üìÑ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ üìÑ CLEAN_ARCHITECTURE.md        # –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
‚îî‚îÄ‚îÄ üìÑ TechnicalDocument.md         # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
```

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

#### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏**

| –°–ª–æ–π | –§–∞–π–ª—ã | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------|------------|
| **Domain Layer** | `internal/model/entities.go` | –ß–∏—Å—Ç—ã–µ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π |
| **Repository Layer** | `internal/repository/*.go` | –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ |
| **Service Layer** | `internal/service/*.go` | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ GraphQL —Ä–µ–∑–æ–ª–≤–µ—Ä—ã |
| **API Layer** | `internal/api/*.go` | HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã |
| **Converter Layer** | `internal/converter/*.go` | –ò–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã |

#### **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------|------------|
| **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞** | `cmd/app/main.go` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | `internal/config/config.go` | –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| **–î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏** | `internal/model/entities.go` | Post, Comment, PostWithComments, CommentTree |
| **API –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã** | `internal/converter/api_converter.go` | GraphQL –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã |
| **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞** | `internal/repository/storage.go` | Storage, PostRepository, CommentRepository |
| **PostgreSQL —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** | `internal/repository/postgres.go` | –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è PostgreSQL |
| **–ú–æ–¥–µ–ª–∏ –ë–î** | `internal/repository/model/storage_models.go` | PostDB, CommentDB –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| **–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –ë–î** | `internal/repository/converter/converter.go` | Domain ‚Üî Storage –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è |
| **GraphQL —Å—Ö–µ–º–∞** | `internal/service/service.go` | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏ —Ä–µ–∑–æ–ª–≤–µ—Ä–æ–≤ |
| **–†–µ–∑–æ–ª–≤–µ—Ä—ã** | `internal/service/resolvers.go` | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ GraphQL |
| **HTTP —Ö–µ–Ω–¥–ª–µ—Ä—ã** | `internal/api/handler.go` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **Pub/Sub** | `pkg/pubsub/pubsub.go` | –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ |

---

## üîå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|------------|----------|
| `GET` | `/` | GraphQL Playground | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è GraphQL |
| `POST` | `/graphql` | GraphQL API | –û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è GraphQL –∑–∞–ø—Ä–æ—Å–æ–≤ |
| `WebSocket` | `/subscriptions` | WebSocket | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è real-time –ø–æ–¥–ø–∏—Å–æ–∫ |
| `GET` | `/health` | Health Check | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ |

### GraphQL API

#### **Query (–ó–∞–ø—Ä–æ—Å—ã)**

##### `posts(limit: Int, offset: Int): [Post!]!`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` (Int, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤
- `offset` (Int, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0) - —Å–º–µ—â–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```graphql
query {
  posts(limit: 5, offset: 0) {
    id
    title
    content
    commentsEnabled
    createdAt
    comments {
      id
      content
      parentId
      createdAt
    }
  }
}
```

##### `post(id: ID!): Post`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –ø–æ ID.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (ID!) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```graphql
query {
  post(id: "35d67a04-2829-4380-8f82-bcfdf8e5ca16") {
    id
    title
    content
    commentsEnabled
    createdAt
    comments {
      id
      content
      parentId
      createdAt
      children {
        id
        content
        createdAt
      }
    }
  }
}
```

#### **Mutation (–ú—É—Ç–∞—Ü–∏–∏)**

##### `createPost(title: String!, content: String!): Post!`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `title` (String!) - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞
- `content` (String!) - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: –æ—Ç 1 –¥–æ 255 —Å–∏–º–≤–æ–ª–æ–≤
- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ: –æ—Ç 1 –¥–æ 10000 —Å–∏–º–≤–æ–ª–æ–≤

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```graphql
mutation {
  createPost(
    title: "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç"
    content: "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞"
  ) {
    id
    title
    content
    commentsEnabled
    createdAt
  }
}
```

##### `createComment(postId: ID!, parentId: ID, content: String!): Comment!`
–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –ø–æ—Å—Ç—É.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `postId` (ID!) - ID –ø–æ—Å—Ç–∞
- `parentId` (ID, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
- `content` (String!) - —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–º–∞–∫—Å. 2000 —Å–∏–º–≤–æ–ª–æ–≤)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –î–ª–∏–Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –Ω–µ –±–æ–ª–µ–µ 2000 —Å–∏–º–≤–æ–ª–æ–≤
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –¥–ª—è –ø–æ—Å—Ç–∞
- –ü–æ—Å—Ç –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```graphql
mutation {
  createComment(
    postId: "35d67a04-2829-4380-8f82-bcfdf8e5ca16"
    content: "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ—Å—Ç!"
  ) {
    id
    content
    parentId
    createdAt
  }
}
```

##### `toggleComments(postId: ID!, enable: Boolean!): Post!`
–í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è –ø–æ—Å—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `postId` (ID!) - ID –ø–æ—Å—Ç–∞
- `enable` (Boolean!) - true –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è, false –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```graphql
mutation {
  toggleComments(
    postId: "35d67a04-2829-4380-8f82-bcfdf8e5ca16"
    enable: false
  ) {
    id
    title
    commentsEnabled
  }
}
```

#### **Subscription (–ü–æ–¥–ø–∏—Å–∫–∏)**

##### `commentAdded(postId: ID!): Comment!`
–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –Ω–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ—Å—Ç—É.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `postId` (ID!) - ID –ø–æ—Å—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –ø–æ–¥–ø–∏—Å–∫–∏:**
```graphql
subscription {
  commentAdded(postId: "35d67a04-2829-4380-8f82-bcfdf8e5ca16") {
    id
    content
    parentId
    createdAt
  }
}
```

### WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª

–î–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: `ws://localhost:8080/subscriptions`
2. **–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏**:
```json
{
  "type": "subscribe",
  "query": "subscription { commentAdded(postId: \"...\") { id content createdAt } }",
  "variables": {
    "postId": "35d67a04-2829-4380-8f82-bcfdf8e5ca16"
  }
}
```

---

## üîß GraphQL Schema

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–æ–≥–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é GraphQL —Å—Ö–µ–º—É:

#### **Post Type**
```graphql
type Post {
  id: ID!
  title: String!
  content: String!
  commentsEnabled: Boolean!
  createdAt: String!
  comments(limit: Int = 10, offset: Int = 0): [Comment!]!
}
```

#### **Comment Type**
```graphql
type Comment {
  id: ID!
  content: String!
  parentId: ID
  createdAt: String!
  children(limit: Int = 10, offset: Int = 0): [Comment!]!
}
```

#### **Operations**
- **Query**: –û–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è (`posts`, `post`)
- **Mutation**: –û–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`createPost`, `createComment`, `toggleComments`)
- **Subscription**: Real-time –ø–æ–¥–ø–∏—Å–∫–∏ (`commentAdded`)

### GraphQL Playground

#### **–î–æ—Å—Ç—É–ø –∫ Playground**
- **URL**: http://localhost:8080/
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GraphQL
  - –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ö–µ–º—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
  - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ WebSocket

### Health Check —ç–Ω–¥–ø–æ–∏–Ω—Ç

#### **GET /health**
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

**–û—Ç–≤–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ:**
```json
{
  "status": "error",
  "error": "database connection failed",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `posts`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|------|-----|----------|-------------|
| `id` | UUID | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | PRIMARY KEY, DEFAULT gen_random_uuid() |
| `title` | VARCHAR(255) | –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞ | NOT NULL |
| `content` | TEXT | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–æ—Å—Ç–∞ | NOT NULL |
| `comments_enabled` | BOOLEAN | –†–∞–∑—Ä–µ—à–µ–Ω—ã –ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | NOT NULL, DEFAULT true |
| `created_at` | TIMESTAMPTZ | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è | NOT NULL, DEFAULT NOW() |

#### –¢–∞–±–ª–∏—Ü–∞ `comments`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|------|-----|----------|-------------|
| `id` | UUID | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | PRIMARY KEY, DEFAULT gen_random_uuid() |
| `post_id` | UUID | –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç | FOREIGN KEY, NOT NULL |
| `parent_id` | UUID | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | FOREIGN KEY, NULL –¥–ª—è –∫–æ—Ä–Ω–µ–≤—ã—Ö |
| `content` | VARCHAR(2000) | –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è | NOT NULL, –º–∞–∫—Å. 2000 —Å–∏–º–≤–æ–ª–æ–≤ |
| `created_at` | TIMESTAMPTZ | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è | NOT NULL, DEFAULT NOW() |

### –ò–Ω–¥–µ–∫—Å—ã
```sql
-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ –ø–æ—Å—Ç—É
CREATE INDEX idx_comments_post_id ON comments(post_id);

-- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
CREATE INDEX idx_comments_parent_id ON comments(parent_id);
```

### –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CTE (Common Table Expression):

```sql
WITH RECURSIVE comment_tree AS (
    -- –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π: –∫–æ—Ä–Ω–µ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    SELECT id, post_id, parent_id, content, created_at, 0 as level
    FROM comments
    WHERE post_id = $1 AND parent_id IS NULL

    UNION ALL

    -- –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —á–∞—Å—Ç—å: –¥–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    SELECT c.id, c.post_id, c.parent_id, c.content, c.created_at, ct.level + 1
    FROM comments c
    INNER JOIN comment_tree ct ON c.parent_id = ct.id
)
SELECT id, post_id, parent_id, content, created_at
FROM comment_tree
ORDER BY created_at;
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|------------|----------|----------------------|--------------|
| `HTTP_ADDR` | –ê–¥—Ä–µ—Å HTTP —Å–µ—Ä–≤–µ—Ä–∞ | `:8080` | –ù–µ—Ç |
| `STORAGE_TYPE` | –¢–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (`postgres`, `memory`) | `postgres` | –ù–µ—Ç |
| `DB_DSN` | –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL | - | –î–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è postgres) |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `info` | –ù–µ—Ç |

### –¢–∏–ø—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

#### PostgreSQL (`STORAGE_TYPE=postgres`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: Production-ready —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å persistent –¥–∞–Ω–Ω—ã–º–∏
- **–§–∞–π–ª—ã**: `internal/repository/postgres.go`, `internal/repository/postgres_test.go`
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ CTE –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
  - ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ foreign key constraints
  - Connection pooling —Å pgxpool
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

#### In-Memory (`STORAGE_TYPE=memory`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
- **–§–∞–π–ª—ã**: `internal/repository/memory.go`, `internal/repository/memory_test.go`
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - Thread-safe –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ sync.RWMutex
  - –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Storage
  - –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ –ø–∞–º—è—Ç–∏
  - –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  - –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
export HTTP_ADDR=":8080"
export STORAGE_TYPE="postgres"
export DB_DSN="postgres://user:password@localhost:5433/postsdb?sslmode=disable"
export LOG_LEVEL="debug"
```

#### Docker Compose
```yaml
environment:
  - HTTP_ADDR=:8080
  - STORAGE_TYPE=postgres
  - DB_DSN=postgres://user:password@db:5432/postsdb?sslmode=disable
  - LOG_LEVEL=info
```

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```bash
git clone https://github.com/NarthurN/CommentsSystem.git
cd CommentsSystem
```

2. **–ó–∞–ø—É—Å–∫:**
```bash
docker compose up -d
```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker compose logs app

# Health check
curl http://localhost:8080/health
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
go mod download
```

2. **–ó–∞–ø—É—Å–∫ PostgreSQL:**
```bash
docker compose up -d db
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
export DB_DSN="postgres://user:password@localhost:5433/postsdb?sslmode=disable"
export STORAGE_TYPE="postgres"
export HTTP_ADDR=":8080"
export LOG_LEVEL="debug"
```

4. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
```bash
go run cmd/app/main.go
```

### –ö–æ–º–∞–Ω–¥—ã Make

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
make build              # –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make run               # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make docker-build      # –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
make docker-up         # –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make docker-down       # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make test              # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
make test-unit         # –¢–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã
make test-coverage     # –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make deps             # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make clean            # –û—á–∏—Å—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

# –ü–æ–º–æ—â—å
make help             # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

| –¢–∏–ø —Ç–µ—Å—Ç–æ–≤ | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------------|------------|
| **Unit —Ç–µ—Å—Ç—ã** | `internal/service/service_test.go` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ |
| **Integration —Ç–µ—Å—Ç—ã** | `internal/repository/postgres_test.go` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î |
| **Mock —Ç–µ—Å—Ç—ã** | –í—Å—Ç—Ä–æ–µ–Ω—ã –≤ unit —Ç–µ—Å—Ç—ã | –ò–∑–æ–ª—è—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π |

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
make test

# –¢–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã (–±–µ–∑ –ë–î)
make test-unit
# –∏–ª–∏
go test -short ./internal/...

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
go test ./internal/repository/

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make test-coverage
# –∏–ª–∏
go test -cover ./internal/...

# –¢–µ—Å—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
go test ./internal/service/
```

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

#### Unit —Ç–µ—Å—Ç —Å –º–æ–∫-–æ–±—ä–µ–∫—Ç–∞–º–∏
```go
func TestCreateComment_Validation(t *testing.T) {
    mockStorage := NewMockStorage()
    ps := pubsub.New()
    svc, err := service.New(mockStorage, ps)

    // –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª–∏–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
    // –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    // –¢–µ—Å—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–∞
}
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
```go
func TestPostgresStorage_CommentHierarchy(t *testing.T) {
    if testing.Short() {
        t.Skip("Skipping integration test")
    }

    // –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π PostgreSQL
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### Health Check

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl http://localhost:8080/health

# –û—Ç–≤–µ—Ç –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ
{
  "status": "ok",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏:

```go
// –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ
log.Info("Starting server", "addr", config.HTTPAddr)
log.Error("Database connection failed", "error", err)
```

### Graceful Shutdown

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤:

```go
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
c := make(chan os.Signal, 1)
signal.Notify(c, os.Interrupt, syscall.SIGTERM)

<-c
log.Info("Shutting down server...")
```

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø—ã Clean Architecture

1. **Dependency Inversion**: –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–Ω—ã–π —Å–ª–æ–π
2. **Single Responsibility**: –ö–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
3. **Interface Segregation**: –ú–µ–ª–∫–∏–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
4. **Open/Closed**: –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –º–µ–∂–¥—É —Å–ª–æ—è–º–∏

#### API ‚Üî Domain –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã (`internal/converter/`)
```go
type GraphQLConverter struct{}
func (c *GraphQLConverter) PostToGraphQL(post *model.Post) map[string]interface{}
func (c *GraphQLConverter) PostsToGraphQL(posts []*model.Post) []interface{}

type ValidationConverter struct{}
func (c *ValidationConverter) ValidateAndConvertPostInput(title, content string) (*model.Post, error)
```

#### Domain ‚Üî Storage –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã (`internal/repository/converter/`)
```go
type PostConverter struct{}
func (c *PostConverter) ToStorage(post *model.Post) *storage_model.PostDB
func (c *PostConverter) FromStorage(postDB *storage_model.PostDB) *model.Post

type CommentConverter struct{}
func (c *CommentConverter) ToStorage(comment *model.Comment) *storage_model.CommentDB
func (c *CommentConverter) FromStorage(commentDB *storage_model.CommentDB) *model.Comment
```

### –ú–æ–¥–µ–ª–∏ –ø–æ —Å–ª–æ—è–º

#### Domain –º–æ–¥–µ–ª–∏ (`internal/model/entities.go`)
```go
type Post struct {
    ID              uuid.UUID `json:"id"`
    Title           string    `json:"title"`
    Content         string    `json:"content"`
    CommentsEnabled bool      `json:"commentsEnabled"`
    CreatedAt       time.Time `json:"createdAt"`
}
```

#### Storage –º–æ–¥–µ–ª–∏ (`internal/repository/model/storage_models.go`)
```go
type PostDB struct {
    ID              string    `db:"id"`
    Title           string    `db:"title"`
    Content         string    `db:"content"`
    CommentsEnabled bool      `db:"comments_enabled"`
    CreatedAt       time.Time `db:"created_at"`
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–∫-–æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è
2. **–ò–∑–æ–ª—è—Ü–∏—è**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º —Å–ª–æ–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ
3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –ü—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö storage –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏–ª–∏ API —Ñ–æ—Ä–º–∞—Ç–æ–≤
4. **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
5. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö

### Real-time –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### WebSocket –ø–æ–¥–ø–∏—Å–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ –Ω–æ–≤—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Pub/Sub –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- Graceful handling –æ—Ç–∫–ª—é—á–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤

#### Pub/Sub —Å–∏—Å—Ç–µ–º–∞
```go
// –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è –æ –Ω–æ–≤–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
topicName := fmt.Sprintf("post:%s:comments", postID.String())
s.pubsub.Publish(topicName, createdComment)

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
subscriber := s.pubsub.Subscribe(topicName, subscriberID)
```

---

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Connection pooling –¥–ª—è PostgreSQL
- In-memory Pub/Sub –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- Stateless –¥–∏–∑–∞–π–Ω —Å–µ—Ä–≤–∏—Å–∞
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é
- –ò–∑–æ–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
